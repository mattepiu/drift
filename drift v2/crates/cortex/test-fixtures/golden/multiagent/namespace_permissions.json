{
  "description": "Namespace permissions: agent, team, project scopes with various grants. Verifies default permissions and explicit grants/revokes.",
  "input": {
    "agents": [
      { "id": "agent-owner", "name": "owner" },
      { "id": "agent-member", "name": "member" },
      { "id": "agent-outsider", "name": "outsider" }
    ],
    "namespaces": [
      {
        "uri": "agent://agent-owner/",
        "scope": "agent",
        "owner": "agent-owner"
      },
      {
        "uri": "team://backend/",
        "scope": "team",
        "owner": "agent-owner",
        "members": ["agent-member"]
      },
      {
        "uri": "project://cortex/",
        "scope": "project",
        "owner": "agent-owner",
        "members": ["agent-member"]
      }
    ],
    "grants": [
      {
        "namespace": "team://backend/",
        "agent": "agent-member",
        "permissions": ["read", "write"],
        "granted_by": "agent-owner"
      },
      {
        "namespace": "project://cortex/",
        "agent": "agent-member",
        "permissions": ["read"],
        "granted_by": "agent-owner"
      }
    ]
  },
  "expected_output": {
    "permission_checks": [
      { "namespace": "agent://agent-owner/", "agent": "agent-owner", "permission": "read", "allowed": true },
      { "namespace": "agent://agent-owner/", "agent": "agent-owner", "permission": "write", "allowed": true },
      { "namespace": "agent://agent-owner/", "agent": "agent-owner", "permission": "share", "allowed": true },
      { "namespace": "agent://agent-owner/", "agent": "agent-owner", "permission": "admin", "allowed": true },
      { "namespace": "agent://agent-owner/", "agent": "agent-outsider", "permission": "read", "allowed": false },
      { "namespace": "agent://agent-owner/", "agent": "agent-outsider", "permission": "write", "allowed": false },
      { "namespace": "team://backend/", "agent": "agent-member", "permission": "read", "allowed": true },
      { "namespace": "team://backend/", "agent": "agent-member", "permission": "write", "allowed": true },
      { "namespace": "team://backend/", "agent": "agent-member", "permission": "admin", "allowed": false },
      { "namespace": "team://backend/", "agent": "agent-outsider", "permission": "read", "allowed": false },
      { "namespace": "project://cortex/", "agent": "agent-member", "permission": "read", "allowed": true },
      { "namespace": "project://cortex/", "agent": "agent-member", "permission": "write", "allowed": false },
      { "namespace": "project://cortex/", "agent": "agent-outsider", "permission": "read", "allowed": false }
    ]
  }
}

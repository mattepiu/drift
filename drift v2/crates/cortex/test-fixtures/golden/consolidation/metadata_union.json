{
  "description": "3 episodic memories with different tags, files, and patterns â†’ verify union of metadata in consolidated output",
  "input": {
    "memories": [
      {
        "id": "ep-060",
        "memory_type": "episodic",
        "content": { "type": "episodic", "data": { "interaction": "Added rate limiting to the API gateway. Using token bucket algorithm with 100 req/s burst.", "context": "API security hardening", "outcome": "Rate limiter deployed" } },
        "summary": "Implemented token bucket rate limiter at 100 req/s burst",
        "transaction_time": "2026-01-10T10:00:00Z", "valid_time": "2026-01-10T10:00:00Z", "valid_until": null,
        "confidence": 0.88, "importance": "high",
        "last_accessed": "2026-01-22T08:00:00Z", "access_count": 5,
        "linked_patterns": [{ "pattern_id": "pat-001", "pattern_name": "rate-limiting" }],
        "linked_constraints": [],
        "linked_files": [{ "file_path": "src/gateway/rate_limiter.rs", "line_start": 1, "line_end": 80, "content_hash": "rl_hash" }],
        "linked_functions": [{ "function_name": "check_rate_limit", "file_path": "src/gateway/rate_limiter.rs", "signature": "fn check_rate_limit(client_id: &str) -> bool" }],
        "tags": ["security", "rate-limiting", "api"],
        "archived": false, "superseded_by": null, "supersedes": null, "content_hash": "hash_ep060"
      },
      {
        "id": "ep-061",
        "memory_type": "episodic",
        "content": { "type": "episodic", "data": { "interaction": "Added IP-based throttling as a second layer. Blocks IPs exceeding 1000 req/min.", "context": "DDoS mitigation", "outcome": "IP throttling active" } },
        "summary": "Added IP-based throttling: block at 1000 req/min",
        "transaction_time": "2026-01-14T11:00:00Z", "valid_time": "2026-01-14T11:00:00Z", "valid_until": null,
        "confidence": 0.85, "importance": "high",
        "last_accessed": "2026-01-23T09:00:00Z", "access_count": 3,
        "linked_patterns": [{ "pattern_id": "pat-002", "pattern_name": "ip-throttling" }],
        "linked_constraints": [{ "constraint_id": "con-001", "constraint_name": "max-ip-rate" }],
        "linked_files": [{ "file_path": "src/gateway/ip_throttle.rs", "line_start": 1, "line_end": 60, "content_hash": "ip_hash" }],
        "linked_functions": [],
        "tags": ["security", "throttling", "ddos"],
        "archived": false, "superseded_by": null, "supersedes": null, "content_hash": "hash_ep061"
      },
      {
        "id": "ep-062",
        "memory_type": "episodic",
        "content": { "type": "episodic", "data": { "interaction": "Configured retry-after headers in rate limit responses. Clients get 429 with Retry-After: 60.", "context": "API response standards", "outcome": "Retry-After headers added" } },
        "summary": "Rate limit responses return 429 with Retry-After: 60 header",
        "transaction_time": "2026-01-18T14:00:00Z", "valid_time": "2026-01-18T14:00:00Z", "valid_until": null,
        "confidence": 0.82, "importance": "normal",
        "last_accessed": "2026-01-24T10:00:00Z", "access_count": 2,
        "linked_patterns": [],
        "linked_constraints": [],
        "linked_files": [{ "file_path": "src/gateway/responses.rs", "line_start": 30, "line_end": 45, "content_hash": "resp_hash" }],
        "linked_functions": [],
        "tags": ["api", "http", "rate-limiting"],
        "archived": false, "superseded_by": null, "supersedes": null, "content_hash": "hash_ep062"
      }
    ]
  },
  "expected_output": {
    "created_count": 1,
    "metadata_union": {
      "tags_superset": ["security", "rate-limiting", "api", "throttling", "ddos", "http"],
      "linked_files_count_min": 3,
      "linked_patterns_count_min": 2,
      "linked_constraints_count_min": 1,
      "linked_functions_count_min": 1
    }
  }
}

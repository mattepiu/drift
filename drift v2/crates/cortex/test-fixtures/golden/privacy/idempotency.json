{
  "description": "sanitize(sanitize(x)) == sanitize(x) â€” sanitization must be idempotent",
  "input": {
    "samples": [
      {
        "id": "idem-01",
        "original": "Contact john.smith@example.com for the API key ghp_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgh",
        "first_pass": "Contact [EMAIL] for the API key [GITHUB_TOKEN]",
        "second_pass": "Contact [EMAIL] for the API key [GITHUB_TOKEN]"
      },
      {
        "id": "idem-02",
        "original": "SSN: 123-45-6789, password = 'my_secret_pass_123'",
        "first_pass": "SSN: [SSN], [PASSWORD]",
        "second_pass": "SSN: [SSN], [PASSWORD]"
      },
      {
        "id": "idem-03",
        "original": "Server at 192.168.1.100 with key sk_fake_XXXXXXXXXXXXXXXXXXXXXXXX",
        "first_pass": "Server at [IP_ADDRESS] with key [STRIPE_KEY]",
        "second_pass": "Server at [IP_ADDRESS] with key [STRIPE_KEY]"
      },
      {
        "id": "idem-04",
        "original": "No sensitive data here, just regular code: fn main() { println!(\"hello\"); }",
        "first_pass": "No sensitive data here, just regular code: fn main() { println!(\"hello\"); }",
        "second_pass": "No sensitive data here, just regular code: fn main() { println!(\"hello\"); }"
      },
      {
        "id": "idem-05",
        "original": "Already sanitized: [EMAIL] and [AWS_KEY] are placeholders",
        "first_pass": "Already sanitized: [EMAIL] and [AWS_KEY] are placeholders",
        "second_pass": "Already sanitized: [EMAIL] and [AWS_KEY] are placeholders"
      }
    ]
  },
  "expected_output": {
    "all_idempotent": true,
    "property": "For all inputs x: sanitize(sanitize(x)) == sanitize(x)",
    "placeholders_not_re_sanitized": true,
    "description": "Placeholder tokens like [EMAIL] must not be detected as PII/secrets on subsequent passes"
  }
}

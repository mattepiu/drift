{
  "description": "Memories already sent in the current session should be filtered from results",
  "input": {
    "stored_memories": [
      {
        "id": "mem-r50",
        "memory_type": "semantic",
        "content": { "type": "semantic", "data": { "knowledge": "Error handling uses thiserror for structured errors. Each crate has its own error enum.", "source_episodes": ["ep-500"], "consolidation_confidence": 0.88 } },
        "summary": "thiserror for structured errors, per-crate error enums",
        "confidence": 0.88, "importance": "normal",
        "tags": ["error-handling"],
        "content_hash": "hash_r50"
      },
      {
        "id": "mem-r51",
        "memory_type": "semantic",
        "content": { "type": "semantic", "data": { "knowledge": "Error conversion uses From impls to auto-convert sub-errors to CortexError. The ? operator propagates errors cleanly.", "source_episodes": ["ep-501"], "consolidation_confidence": 0.85 } },
        "summary": "From impls for auto error conversion, ? operator propagation",
        "confidence": 0.85, "importance": "normal",
        "tags": ["error-handling"],
        "content_hash": "hash_r51"
      }
    ],
    "query": {
      "focus": "error handling patterns",
      "intent": "understand_code",
      "active_files": [],
      "budget": 2000,
      "sent_ids": ["mem-r50"]
    }
  },
  "expected_output": {
    "results_min": 1,
    "must_contain_ids": ["mem-r51"],
    "must_not_contain_ids": ["mem-r50"],
    "reason": "mem-r50 was already sent in this session (in sent_ids), so it should be filtered out"
  }
}

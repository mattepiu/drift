{
  "description": "Memories linked to the same file as the active editor should get a proximity boost",
  "input": {
    "stored_memories": [
      {
        "id": "mem-r80",
        "memory_type": "semantic",
        "content": { "type": "semantic", "data": { "knowledge": "The storage engine uses connection pooling with r2d2. Pool size is configurable via StorageConfig.", "source_episodes": ["ep-800"], "consolidation_confidence": 0.85 } },
        "summary": "Storage engine uses r2d2 connection pooling, configurable pool size",
        "confidence": 0.85, "importance": "normal",
        "linked_files": [{ "file_path": "cortex-storage/src/engine.rs", "line_start": 1, "line_end": 50, "content_hash": "eng_hash" }],
        "tags": ["storage", "connection-pool"],
        "content_hash": "hash_r80"
      },
      {
        "id": "mem-r81",
        "memory_type": "semantic",
        "content": { "type": "semantic", "data": { "knowledge": "The retrieval engine orchestrates the 2-stage pipeline. It depends on IMemoryStorage and ICompressor traits.", "source_episodes": ["ep-801"], "consolidation_confidence": 0.85 } },
        "summary": "Retrieval engine orchestrates 2-stage pipeline via storage and compressor traits",
        "confidence": 0.85, "importance": "normal",
        "linked_files": [{ "file_path": "cortex-retrieval/src/engine.rs", "line_start": 1, "line_end": 80, "content_hash": "ret_hash" }],
        "tags": ["retrieval", "architecture"],
        "content_hash": "hash_r81"
      }
    ],
    "query": {
      "focus": "engine architecture",
      "intent": "understand_code",
      "active_files": ["cortex-storage/src/engine.rs"],
      "budget": 2000,
      "sent_ids": []
    }
  },
  "expected_output": {
    "results_min": 2,
    "top_result_id": "mem-r80",
    "reason": "mem-r80 is linked to cortex-storage/src/engine.rs which is in active_files, giving it a file proximity boost over mem-r81"
  }
}

{
  "description": "RRF (Reciprocal Rank Fusion) should correctly combine FTS5 keyword and vector search results",
  "input": {
    "stored_memories": [
      {
        "id": "mem-r20",
        "memory_type": "semantic",
        "content": { "type": "semantic", "data": { "knowledge": "The caching layer uses moka with TinyLFU admission policy. L1 cache holds 10K entries with per-entry TTL. Eviction is size-aware.", "source_episodes": ["ep-200"], "consolidation_confidence": 0.85 } },
        "summary": "Caching: moka TinyLFU, 10K entries, per-entry TTL, size-aware eviction",
        "confidence": 0.85, "importance": "normal",
        "tags": ["caching", "moka", "performance"],
        "content_hash": "hash_r20"
      },
      {
        "id": "mem-r21",
        "memory_type": "tribal",
        "content": { "type": "tribal", "data": { "knowledge": "Always invalidate the moka cache when updating memory content. Stale cache entries cause retrieval to return outdated embeddings.", "severity": "high", "warnings": ["Stale embeddings degrade search quality"], "consequences": ["Users get irrelevant results"] } },
        "summary": "Must invalidate moka cache on memory content updates",
        "confidence": 0.92, "importance": "high",
        "tags": ["caching", "moka", "invalidation"],
        "content_hash": "hash_r21"
      },
      {
        "id": "mem-r22",
        "memory_type": "decision",
        "content": { "type": "decision", "data": { "decision": "Use blake3 for cache keys instead of SHA-256", "rationale": "blake3 is 3x faster and provides sufficient collision resistance for cache keys", "alternatives": [{ "description": "SHA-256", "reason_rejected": "Slower, overkill for non-cryptographic cache keys" }] } },
        "summary": "blake3 for cache keys â€” 3x faster than SHA-256",
        "confidence": 0.90, "importance": "normal",
        "tags": ["caching", "blake3", "hashing"],
        "content_hash": "hash_r22"
      }
    ],
    "query": {
      "focus": "moka cache invalidation stale entries",
      "intent": "fix_bug",
      "active_files": [],
      "budget": 2000,
      "sent_ids": []
    }
  },
  "expected_output": {
    "results_min": 2,
    "top_result_id": "mem-r21",
    "must_contain_ids": ["mem-r21", "mem-r20"],
    "rrf_behavior": {
      "description": "mem-r21 ranks highest because it appears in both FTS5 (keyword 'moka cache invalidation') and vector results, getting boosted by RRF fusion",
      "rrf_k": 60
    }
  }
}
